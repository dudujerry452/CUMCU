# 线性代数扩展及其应用

Def. 凸集: $M$为线性空间$V$的子集, $\forall v_1, v_2 \in M$, 若$\forall t\in [0,1]$, 有$tv_1 + (1-t)v_2 \in M$, 则$M$是一个凸集. 

Def. 凸包. 若线性空间中包含的任意包含$v_1, v_2, .., v_k$的凸集$M$, 都有$C\subset M$



## 对称矩阵的可对角化

$$
P^TAP = D
$$

A: 对称矩阵: 纯形变

P: 正交矩阵: 刚体变换(没有压缩/拉伸)

D: 对称矩阵的特征值: 不同正交方向的伸缩值

## 对称矩阵的谱分解

$$
A = \lambda_1 u_1 u_1^T + \lambda_2 u_2u_2^T + ... + \lambda_ku_ku_k^T
$$

该公式的意义是做正交分解, 分解出k个方向的正交分量

### 计算$x^TAx$的最大最小值, $||x|| = 1$: 

设$x^Tu_i = y_i$

则$x = y_1u_1 + y_2u_2 + ... + y_ku_k$ (将x在新的正交坐标系中投影)

$x^TAx = \lambda_1 y_1^2 + \lambda_2 y_2^2 + \lambda_3 y_3^2$

由于$u_i$是标准正交的, 因此$u_i u_i = 1$

所以$x^Tx = y_1^2 + y_2^2 + ... + y_k^2 = 1$

因此$||x||$的约束就变为 $ y_1^2 + y_2^2 + ... + y_k^2 = 1 $. 

问题变为: 
$$
max(x^TAx) = max(\lambda_1 y_1^2 + \lambda_2 y_2^2 + \lambda_3 y_3^2) \\ 
约束: y_1^2 + y_2^2 + ... + y_k^2 = 1
$$
对其进行整体放缩, 假设
$$
\lambda_1 \leq \lambda_2 \leq \lambda_3 ...
$$


得到
$$
\lambda_1 \leq x^TAx \leq \lambda_k
$$
于是可以知道其最大值为$A$的特征值, 为了求出$x$

## 主成分分析

例如, 对于n个向量组成的矩阵$M$, 计算出$M^TM$得到的特征值就可以知道${v_i}$在空间中的分布特征

## 奇异值(SVD)分解

对矩阵A(mxn), P(nxn), 有
$$
P^TA^TAP = D_1
$$
合理安排$P$的列向量, 使得$D_1$的前$r(A)$个主对角线上元素不为0, 设$Q = AP$, 则有
$$
Q^TQ = D_1
$$
这说明, Q的任意两个列向量相互垂直, 且后$m-r(A)$个向量为0向量. 

现对$Q$进行改造, 使得前$r(A)$个列向量单位化, 并添加$m-r(A)$个与前面方向垂直的列向量. 



因此, A可以被分解为
$$
A = USV
$$
其中U, V是两个正交矩阵, S是一个对角

## 线性方程的最小二乘解

$A: m\times n, m>n, r(A) = n$

此时A一般无解, 要求$||Ax-b||$最小, 不能让方程成立, 但使残差最小. 

满足条件

$$Ax_0 - b \in col(T)^\perp$$

即满足$A^TAx_0 = A^Tb$

## 最小模解

对$A: m\times n, n > m, r(A) = m$, 此时$Ax=b$有无数解, 如何求$||x||$最小的解. 

设$x_0$是最小的解, 那么通解可表示为$x = x_0 + v$, 其中$v \in Nul(A)$, 并且有
$$
v \perp x_0
$$
可以得到$AA^Ty = A^Tb$

## 最小模最小二乘解

对A进行SVD分解, 
$$
\hat x = A^Ty = V^TS^{-1}U^Tb
$$
$S^{-1}$不是逆矩阵, 而是对所有元素取倒数

## MP广义逆矩阵

Moore-Penrose逆矩阵, 对mxn的矩阵A, 存在唯一nxm的矩阵G, 满足
$$
AGA = G \\ 
GAG = A \\ 
(GA)^T = GA  \\ 
(AG)^T = AG 
$$

###  SVD分解与MP广义逆

令$G = V^TS^{-1}U^T$, 则$x = Gb$, 因此只需要求出其MP逆矩阵即可

### MP广义逆的计算

...

# 微分方程

## 方阵的指数运算

设$X(t)$是一个n维关于t的函数向量, $A$是一个$n\times n$的矩阵

微分方程中 
$$
\dfrac{dX}{dt} = AX
$$
如何求解X? 

$X = X_0 e^{At} = (1 + At + \dfrac{A^2}{2!}t^2 + \dfrac{A^3}{3!}t^3 + ...)X_0$

验证: 
$$
\dfrac{d}{dt}X = (A + A^2t + \dfrac{A^3}{2!}t^2 + ...) = AX
$$
验证成功. 

计算expm: 可对角化和不可对角化(没听懂)



## 复数乘法

复数相乘: 模长相乘, 辐角相加

### 计算一元三次方程

对
$$
y^3 + 3py + 2q = 0 \\ 
令y = \alpha+\beta  \\ 
\alpha^3 + 3\alpha^2\beta+3\alpha\beta^2 + \beta^3+ 3p\alpha + 3p\beta + 2q = 0 \\
\alpha^3 + \beta^3 + 3\alpha\beta(\alpha+\beta) = 
$$
没听懂( 

#### 计算角度要选择atan2(y,x)

优点: 

- 只要两个有一个不是0, 就会有输出. 
- arcsin, arccos, 这两个函数在0和1附近非适定性
- atan不能算无穷

### 计算一元四次方程

可用于求两条圆锥曲线的交点, 即二元二次方程解

### 二元二次方程

当该方程为两条直线交点时, 可以分解因式为两个一元一次方程的乘积

进一步地说, 当圆锥曲线退化时, 即对称矩阵的行列式为0时可以因式分解. 

##### 两条圆锥曲线求交点

退化方程导出: 
$$
|A_1 + tA_2| = 0
$$
由于$A_1 + tA_2$是三阶方阵, 每个元素都是一次多项式, 因此$A_1 + tA_2$的元素最多为三次, 转化为一元三次方程可解. 

### 四次方程求根公式的几何意义

椭圆和抛物线的交点

##  张量

标量: 0阶张量

向量: 1阶张量

矩阵: 2阶张量

注意到, 两个一阶张量(向量)的变换用二阶张量(矩阵)的变换表示. 